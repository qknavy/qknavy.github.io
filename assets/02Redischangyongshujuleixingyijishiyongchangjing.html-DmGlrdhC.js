import{_ as l,c as i,a as p,b as n,d as a,e as t,r as c,o}from"./app-ZtzIEswt.js";const r={},u={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/",target:"_blank",rel:"noopener noreferrer"},d={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#string-commands",target:"_blank",rel:"noopener noreferrer"},m={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#hash-commands",target:"_blank",rel:"noopener noreferrer"},k={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#list-commands",target:"_blank",rel:"noopener noreferrer"},b={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#set-commands",target:"_blank",rel:"noopener noreferrer"},v={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#sorted-set-commands",target:"_blank",rel:"noopener noreferrer"},h={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#bitmap-commands",target:"_blank",rel:"noopener noreferrer"},g={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#hyperloglog-commands",target:"_blank",rel:"noopener noreferrer"},y={href:"https://redis.io/docs/latest/commands/redis-8-2-commands/#geospatial-commands",target:"_blank",rel:"noopener noreferrer"};function f(q,s){const e=c("ExternalLinkIcon");return o(),i("div",null,[s[11]||(s[11]=p('<blockquote><p>本文介绍了redis的数据结构以及value常见的数据类型，包括基本使用、使用场景以及底层的数据结构实现</p></blockquote><p>之前已经介绍了redis的三种安装方式，为什么redis的性能这么好呢？主要是因为以下几点：</p><ul><li>redis是基于内存的操作，操作不需要进行磁盘交互</li><li>redis本身是基于类似k-v这种键值对结构，所以查询数据非常快</li><li>redis底层对于多种数据结构的优化使用，比如调表、SDS</li><li>redis执行命令是单线程的，没有线程切换的时间消耗，同时在IO过程中使用了多路复用机制，每个线程中通过记录每个sock（IO流）的状态来管理多个I/O流</li></ul><p>此外，redis本身在数据一致性方面提供了持久化机制和多种过期策略，并且提供了高可用集群方案</p><h2 id="_1、redis的数据结构" tabindex="-1"><a class="header-anchor" href="#_1、redis的数据结构"><span>1、redis的数据结构</span></a></h2><h3 id="_1-1、redis的数据结构" tabindex="-1"><a class="header-anchor" href="#_1-1、redis的数据结构"><span>1.1、redis的数据结构</span></a></h3><p>redis的数据结构如下图所示：</p><p><img src="http://blog.shengxiao.tech/images/image-20260116090541116.png" alt="image-20260116090541116"></p><p>整体是一个dict的结构，在dict里边定义了一个长度为2的数组dictht，主要利用空间换时间的理念，在扩缩容的时候会用到，平时只会用到ht[0]。在ht[0].table里边是一个dictEntry数组，每个dictEntry是一个key-value的格式，其中key是redis定义的SDS格式，value是RedisObject对象格式，根据数据不同会采用不能的数据类型</p><h3 id="_1-2、扩容" tabindex="-1"><a class="header-anchor" href="#_1-2、扩容"><span>1.2、扩容</span></a></h3><blockquote><p>ht[0]的size默认大小为4</p></blockquote><ul><li><p>扩容条件</p><ul><li>当没有子进程进行数据持久化的时候（同步数据到磁盘），ht[0].used&gt;=ht[0].size的时候</li><li>当有子进程在进行数据持久化的时候，ht[0].used&gt;ht[0].size*5</li></ul></li><li><p>扩容时机</p><ul><li>添加数据的时候：<code>dictReplace</code> -&gt; <code>dictAddRaw</code></li></ul></li><li><p>如何扩容</p><ul><li>当触发扩容的时候，如果当前状态是正在扩容，或者计算出来扩容后的大小跟ht[0]的size一样，则不进行其它操作</li><li>new一个新的dictht，大小为ht[0].size*2然后向上取临近的2的n次幂</li></ul><blockquote><p>当要扩容的时候，redis会new一个dictht，并且空间大小是原来的size的两倍并向上取接近2的幂次方，比如原来usedsize=4，扩容后新的dictht的大小就是8，如果之前usedsize为6，则扩容后的大小为16</p></blockquote><ul><li>ht[1]=new的dictht，rehashidx=0（准备好了数据，可以迁移了）</li><li>数据迁移（渐进式迁移，不会阻塞当前线程任务） <ul><li>每次增删改查的时候如果rehashidx!=-1的时候，都会进行数据迁移，但是不会每次全部迁移，只会迁移一个hash桶，比如上面图示的dictEntry[0]，第一个桶迁移完成后rehashidx加1，下次迁移第二个hash桶</li><li>定时任务触发（serverCron事件迁移），同样只会迁移部分数据，但是可能一次会迁移N个哈希桶，定时可配（server.hz，默认100ms一次）一次迁移数据量可配（默认100个桶，但是要求在指定时间之内完成，在这个时间内能迁移多少个就迁移多少个）</li><li>遇到空桶继续迁移，直到循环超过10个空桶、或者达到要迁移的桶数，比如要迁移20个桶，当在迁移第19个的时候发现是个空桶，则继续看第20个桶，如果第20个还是空桶，继续看第21个，直到再迁移2个达到20个桶迁移的目标，或者接下来10个桶都是空桶的化，则本次迁移到此为止，也就是只迁移了前面的18个桶</li></ul></li><li>数据迁移完成后，ht[0]=ht[1]，ht[1]释放：即ht[1].table=null, ht[1].size=0，并且dict的rehashidx的标识改为-1（当前没有任务在做迁移）</li></ul></li></ul><h2 id="_2、redis的value常见数据类型" tabindex="-1"><a class="header-anchor" href="#_2、redis的value常见数据类型"><span>2、redis的value常见数据类型</span></a></h2>',13)),n("p",null,[s[1]||(s[1]=a("从redis的 ",-1)),n("a",u,[s[0]||(s[0]=a("官方文档",-1)),t(e)]),s[2]||(s[2]=a(" 支持的命令就可以看到，redis支持的数据类型特别丰富",-1))]),s[12]||(s[12]=n("h3",{id:"_2-1、string类型",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_2-1、string类型"},[n("span",null,"2.1、String类型")])],-1)),n("ul",null,[n("li",null,[n("a",d,[s[3]||(s[3]=a("String commands",-1)),t(e)])])]),s[13]||(s[13]=p(`<h4 id="_2-1-1、string相关的命令" tabindex="-1"><a class="header-anchor" href="#_2-1-1、string相关的命令"><span>2.1.1、String相关的命令</span></a></h4><p><img src="http://blog.shengxiao.tech/images/image-20260114143231961.png" alt="image-20260114143231961"></p><p>比如：</p><ul><li>给key为name设置值为Navy：</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name Navy</span>
<span class="line">OK</span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token string">&quot;Navy&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>给名称为<code>name</code>的这个key设置过期时间为5s（<code>ttl key</code>查看key的过期时间）</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setex name <span class="token number">5</span> name</span>
<span class="line">OK</span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token string">&quot;name&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl name</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token string">&quot;name&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token string">&quot;name&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token punctuation">(</span>nil<span class="token punctuation">)</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl name</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>删除key</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> del name</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token punctuation">(</span>nil<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>批量设置<code>name</code>的value是<code>liu</code>，<code>age</code>是18</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset name liu age <span class="token number">18</span></span>
<span class="line">OK</span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name</span>
<span class="line"><span class="token string">&quot;liu&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get age</span>
<span class="line"><span class="token string">&quot;18&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>String类型的对应的value能够存储的数据类型非常多，如String、number、float、bits等，其中数字类型的比如number、float都可以用<code>incrby</code>命令，比如</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> score <span class="token number">85.2</span></span>
<span class="line">OK</span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrbyfloat score <span class="token number">10</span></span>
<span class="line"><span class="token string">&quot;95.2&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>整型的就直接<code>incrby</code></p></blockquote><p>其value最大值是512mb。redis的key都是String存储的，所以key的最大值也是512mb</p><h4 id="_2-1-2、应用场景" tabindex="-1"><a class="header-anchor" href="#_2-1-2、应用场景"><span>2.1.2、应用场景</span></a></h4><h5 id="_2-1-2-1、缓存" tabindex="-1"><a class="header-anchor" href="#_2-1-2-1、缓存"><span>2.1.2.1、缓存</span></a></h5><p>String类型的主要使用场景就是作为缓存使用，比如为了减少前端和数据库的交互减轻数据库的压力，对于一些没有强实时性要求的数据，可以将数据在redis中缓存一份，如果前端请求过来的时候先从缓存里拿，如果缓存中没有，则再去查数据库，查到数据的时候再往缓存里写一份并返回，这样下次再来查询同样的数据的时候就可以直接走缓存了不用再去查数据库了</p><p><img src="http://blog.shengxiao.tech/images/image-20260114151017976.png" alt="image-20260114151017976"></p><h5 id="_2-1-2-2、全局id" tabindex="-1"><a class="header-anchor" href="#_2-1-2-2、全局id"><span>2.1.2.2、全局id</span></a></h5><p>前面在介绍String类型数据用法的时候提到一个<code>incr</code> 、<code>incrby</code>指令，由于redis的指令是原子性的，所以可以利用这个指令来生成全局递增的ID。此外也可以利用这个来做分布式场景下的计数</p><h4 id="_2-1-3、底层数据结构-sds" tabindex="-1"><a class="header-anchor" href="#_2-1-3、底层数据结构-sds"><span>2.1.3、底层数据结构-SDS</span></a></h4><p>在redis中，String的底层并没有采用c的char来实现，而是自定义了一种SDS（Simple Dynamic String）的数据结构。下面就是定义的五种SDS结构：</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>sds<span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">/* Note: sdshdr5 is never used, we just access the flags byte directly.</span>
<span class="line"> * However is here to document the layout of type 5 SDS strings. </span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr5</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, and 5 msb of string length */</span></span>
<span class="line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr8</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">uint8_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* used */</span> <span class="token comment">//已使用的长度</span></span>
<span class="line">    <span class="token class-name">uint8_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* excluding the header and null terminator */</span> <span class="token comment">//分配的总容量 不包含头和空终止符</span></span>
<span class="line">    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, 5 unused bits*/</span> <span class="token comment">//低三位类型 高5bit未使用</span></span>
<span class="line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//数据buf 存储字符串数组</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr16</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">uint16_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* used */</span></span>
<span class="line">    <span class="token class-name">uint16_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* excluding the header and null terminator */</span></span>
<span class="line">    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, 5 unused bits */</span></span>
<span class="line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr32</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">uint32_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* used */</span></span>
<span class="line">    <span class="token class-name">uint32_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* excluding the header and null terminator */</span></span>
<span class="line">    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, 5 unused bits */</span></span>
<span class="line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr64</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">uint64_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* used */</span></span>
<span class="line">    <span class="token class-name">uint64_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* excluding the header and null terminator */</span></span>
<span class="line">    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, 5 unused bits */</span></span>
<span class="line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到主要定义了一个char数组，保存具体的值，并且定义了一个标识字段<code>flags</code>（只用到低三位）。此外在除<code>sdshdr5</code>外的其它几种类型中，都定义了已使用长度字段<code>len</code>和预分配了不包含头和空终止符的内存总容量字段<code>alloc</code></p><p><img src="http://blog.shengxiao.tech/images/image-20260115102056317.png" alt="image-20260115102056317"></p><p>SDS的结构大概如上图所示，比如现在初始对应的是‘Hello’这个字符串。其中flags表示使用的是哪种SDS，比如等于1意思用<code>sdshdr8</code>（小于2^8的长度都用<code>sdshdr8</code>，len和alloc都只用两个字节），这个值会根据len去计算选择。另外在SDS中直接保存了字符串的长度，所以如果要获取一个字符串的长度是非常快的，不用像便利字数组那边遍历。后续会根据存放的内容动态进行扩容</p><h5 id="_2-1-3-1、空间换时间" tabindex="-1"><a class="header-anchor" href="#_2-1-3-1、空间换时间"><span>2.1.3.1、空间换时间</span></a></h5><ul><li>预分配</li></ul><p>我们知道，像在hashmap等数据结构中要保存数据，经常会涉及到扩容的问题，同样的，SDS也考虑到了这一点。因为要追求极致的性能，所以redis在设计sds的时候秉承着这一点就采用了空间换时间的理念进行空间预分配。在小于1mb的长度的时候，redis会以两倍的空间分配，大于1mb的时候，会每次加1mb</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line">sds <span class="token function">sdsMakeRoomFor</span><span class="token punctuation">(</span>sds s<span class="token punctuation">,</span> <span class="token class-name">size_t</span> addlen<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">void</span> <span class="token operator">*</span>sh<span class="token punctuation">,</span> <span class="token operator">*</span>newsh<span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">size_t</span> avail <span class="token operator">=</span> <span class="token function">sdsavail</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">size_t</span> len<span class="token punctuation">,</span> newlen<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">char</span> type<span class="token punctuation">,</span> oldtype <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> SDS_TYPE_MASK<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">int</span> hdrlen<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">/* Return ASAP if there is enough space left. */</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>avail <span class="token operator">&gt;=</span> addlen<span class="token punctuation">)</span> <span class="token keyword">return</span> s<span class="token punctuation">;</span></span>
<span class="line">    len <span class="token operator">=</span> <span class="token function">sdslen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    sh <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token operator">-</span><span class="token function">sdsHdrSize</span><span class="token punctuation">(</span>oldtype<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    newlen <span class="token operator">=</span> <span class="token punctuation">(</span>len<span class="token operator">+</span>addlen<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>newlen <span class="token operator">&lt;</span> SDS_MAX_PREALLOC<span class="token punctuation">)</span> <span class="token comment">//小于1M 2倍</span></span>
<span class="line">        newlen <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">else</span></span>
<span class="line">        newlen <span class="token operator">+=</span> SDS_MAX_PREALLOC<span class="token punctuation">;</span> <span class="token comment">//大于1M，每次预分配长度+1M</span></span>
<span class="line">    type <span class="token operator">=</span> <span class="token function">sdsReqType</span><span class="token punctuation">(</span>newlen<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">/* Don&#39;t use type 5: the user is appending to the string and type 5 is</span>
<span class="line">	 * not able to remember empty space, so sdsMakeRoomFor() must be called</span>
<span class="line">	 * at every appending operation. </span>
<span class="line">	 */</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> SDS_TYPE_5<span class="token punctuation">)</span> type <span class="token operator">=</span> SDS_TYPE_8<span class="token punctuation">;</span></span>
<span class="line">    hdrlen <span class="token operator">=</span> <span class="token function">sdsHdrSize</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldtype<span class="token operator">==</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        newsh <span class="token operator">=</span> <span class="token function">s_realloc</span><span class="token punctuation">(</span>sh<span class="token punctuation">,</span> hdrlen<span class="token operator">+</span>newlen<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>newsh <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">        s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>newsh<span class="token operator">+</span>hdrlen<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">/* Since the header size changes, need to move the string forward,</span>
<span class="line">		 * and can&#39;t use realloc </span>
<span class="line">		 */</span></span>
<span class="line">        newsh <span class="token operator">=</span> <span class="token function">s_malloc</span><span class="token punctuation">(</span>hdrlen<span class="token operator">+</span>newlen<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>newsh <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>newsh<span class="token operator">+</span>hdrlen<span class="token punctuation">,</span> s<span class="token punctuation">,</span> len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">s_free</span><span class="token punctuation">(</span>sh<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>newsh<span class="token operator">+</span>hdrlen<span class="token punctuation">;</span></span>
<span class="line">        s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> type<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">sdssetlen</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">sdssetalloc</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> newlen<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> s<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>惰性释放</li></ul><p>在空间动态调整的过程中，可能后续用不到这么多的内存，比如对字符串进行截取的时候，redis并不会立即释放，仅提供相关的API出来，如果用户没有显示释放，则对应的空间还能够继续使用。</p><h5 id="_2-1-3-2、二进制安全" tabindex="-1"><a class="header-anchor" href="#_2-1-3-2、二进制安全"><span>2.1.3.2、二进制安全</span></a></h5><p>sds的二进制安全是相对于c的字符串来说的。</p><p>在c中，字符串的结尾是以空字符串为标识的，也就是说在字符串中间不能出现空字符串，这也就限制了c的字符串只能保存字符串文本。</p><p>而在sds中，它的结束标识符是&#39;\\0&#39;，这就意味着它可以存放任何非&#39;\\0&#39;的字符，也就是说它甚至可以通过二进制的形式保存图片、音频、视频等内容。</p><h4 id="_2-1-4、优缺点" tabindex="-1"><a class="header-anchor" href="#_2-1-4、优缺点"><span>2.1.4、优缺点</span></a></h4><ul><li><p>优点</p><ul><li>查询长度比较快（SDS里边记录了字符串的长度）</li><li>减少修改字符长度带来的内存重新分配（预分配、惰性释放）</li><li>二进制安全</li></ul></li><li><p>缺点</p></li></ul><p>浪费空间</p><h3 id="_2-2、hash类型" tabindex="-1"><a class="header-anchor" href="#_2-2、hash类型"><span>2.2、Hash类型</span></a></h3>`,41)),n("ul",null,[n("li",null,[n("a",m,[s[4]||(s[4]=a("Hash commands",-1)),t(e)])])]),s[14]||(s[14]=p(`<h4 id="_2-2-1、hash类型相关的指令" tabindex="-1"><a class="header-anchor" href="#_2-2-1、hash类型相关的指令"><span>2.2.1、Hash类型相关的指令</span></a></h4><p><img src="http://blog.shengxiao.tech/images/image-20260115133810018.png" alt="image-20260115133810018"></p><p>比如：</p><ul><li>设置一个人的信息</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset person name navy age <span class="token number">18</span> address shanghai phone <span class="token number">17610001100</span></span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hget person name</span>
<span class="line"><span class="token string">&quot;navy&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hget person age</span>
<span class="line"><span class="token string">&quot;18&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hget person address</span>
<span class="line"><span class="token string">&quot;shanghai&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看<code>person</code>这个key的完整内容</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hgetall person</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;navy&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;age&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;18&quot;</span></span>
<span class="line"><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;address&quot;</span></span>
<span class="line"><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;shanghai&quot;</span></span>
<span class="line"><span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;phone&quot;</span></span>
<span class="line"><span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;17610001100&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>给年龄加5岁</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hincrby person age <span class="token number">5</span></span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">23</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hgetall person</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;navy&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;age&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;23&quot;</span></span>
<span class="line"><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;address&quot;</span></span>
<span class="line"><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;shanghai&quot;</span></span>
<span class="line"><span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;phone&quot;</span></span>
<span class="line"><span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;17610001100&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-2、使用场景" tabindex="-1"><a class="header-anchor" href="#_2-2-2、使用场景"><span>2.2.2、使用场景</span></a></h4><p>结合上面简单的使用，可以看出hash类型大概的结构就是一个key下面可以设置多个属性。这一点是不是跟我们java中对象的定义非常像？所以一般用来存储对象比较多。</p><p>举例：</p><p>我们现在要做一个短视频的统计数据，比如点赞数、评论数、收藏数、转发数，可以用这个视频的id作为key，这几个指标作为field，每次有对应的操作执行一次<code>incrby</code>，效率不也是杠杠的</p><h4 id="_2-2-3、底层数据结构-ziplist-dictht哈希表" tabindex="-1"><a class="header-anchor" href="#_2-2-3、底层数据结构-ziplist-dictht哈希表"><span>2.2.3、底层数据结构-ziplist+dictht哈希表</span></a></h4><h5 id="_2-2-3-1、ziplist-压缩列表" tabindex="-1"><a class="header-anchor" href="#_2-2-3-1、ziplist-压缩列表"><span>2.2.3.1、ziplist 压缩列表</span></a></h5><p>ziplist是基于偏移量来定位的</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token operator">&lt;</span>zlbytes<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>zltail<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>zllen<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>zlend<span class="token operator">&gt;</span></span>
<span class="line">字节数		开始位置  entry的长度 entry数据					entry结束</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>而entry的格式为：</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token operator">&lt;</span>prevlen<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>dncoding<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>entry<span class="token operator">-</span>data<span class="token operator">&gt;</span></span>
<span class="line">上一个entry的长度  编码	entry数据</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>大致的意思如下图所示：</p><p><img src="http://blog.shengxiao.tech/images/image-20260115141407362.png" alt="image-20260115141407362"></p><p>一个偏移量找到a，在找2个偏移量找到ab，再找3个偏移量找到abc，再找4个偏移量得到abcd，再找5个偏移量，找到abcde</p><p>但是这样依赖对于数据的变更就非常不友好了，比如将<code>ab</code>改成了<code>abx</code>，这意味着后续的所有数据都要同步更新。而且如果数据越多，连锁更新的影响更大。所以ziplist只适用于数据量小的场景</p><p>当数据量达到一定程度的时候，redis的hash结构使用的是hash表，也就是<code>dictht</code></p><h5 id="_2-2-3-2、dictht-哈希表" tabindex="-1"><a class="header-anchor" href="#_2-2-3-2、dictht-哈希表"><span>2.2.3.2、dictht 哈希表</span></a></h5><p>在<code>redis.conf</code>配置文件中，有一个配置：</p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">#entries的数量不能超过512</span>
<span class="line">hash-max-ziplist-entries 512</span>
<span class="line"></span>
<span class="line">#value的最大值不能超过64byte</span>
<span class="line">hash-max-ziplist-value 64</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也就是在entry（field）少于512且每个的value不超过64byte的时候会用<code>ziplist</code>，超过这个配置的值就会使用哈希表。前面介绍了dictht的结构大致如下图所示，不同的数据类型主要体现在<code>RedisObject</code>上，如果当前采用的是哈希表的化，则redisObject里边嵌套的就是一个dictht，组成<code>key field value</code>这种结构：</p><p><img src="http://blog.shengxiao.tech/images/image-20260115160029398.png" alt="image-20260115160029398"></p><h3 id="_2-3、list类型" tabindex="-1"><a class="header-anchor" href="#_2-3、list类型"><span>2.3、List类型</span></a></h3><h4 id="_2-3-1、list类型相关的指令" tabindex="-1"><a class="header-anchor" href="#_2-3-1、list类型相关的指令"><span>2.3.1、List类型相关的指令</span></a></h4>`,31)),n("ul",null,[n("li",null,[n("a",k,[s[5]||(s[5]=a("List commands",-1)),t(e)])])]),s[15]||(s[15]=p(`<p><img src="http://blog.shengxiao.tech/images/image-20260116093510825.png" alt="image-20260116093510825"></p><ul><li>从左边往list里边添加几个元素</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush students lilei</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush students hanmeimei</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush students lily</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush students lucy</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>从左边拿一个元素</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpop students <span class="token number">1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;lucy&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看list里边的所有元素</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange students <span class="token number">0</span> <span class="token parameter variable">-1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;lily&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;hanmeimei&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;lilei&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在lily和hanmeimei之前插入一个David</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert students before hanmeimei David</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange students <span class="token number">0</span> <span class="token parameter variable">-1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;lily&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;David&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;hanmeimei&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;lilei&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-2、应用场景" tabindex="-1"><a class="header-anchor" href="#_2-3-2、应用场景"><span>2.3.2、应用场景</span></a></h4><p>刚才简单使用了一下list，可以发现它的几个特别，首先就是一个队列，其次是有序分前后。所以我们可以用它来做一些需要排队的场景，比如取号、</p><h4 id="_2-3-3、底层数据结构-quicklist-ziplist" tabindex="-1"><a class="header-anchor" href="#_2-3-3、底层数据结构-quicklist-ziplist"><span>2.3.3、底层数据结构- quicklist+ziplist</span></a></h4><p>在老版本中，list采用的是LinkedList，但是在新版本中采用的是quickList。quickList兼顾了ziplist的节省内存能力，也解决了它的连锁更新问题，因为它采用的是quicklist的节点下挂ziplist的这种结构</p><p><img src="http://blog.shengxiao.tech/images/image-20260116095735163.png" alt="image-20260116095735163"></p><p>ziplist将列表中的每一个元素存放在一个前后连续的地址空间，整体占用一大块内存。经过压缩后的qucklistLZF使用一个柔性数组，存放压缩后的ziplist字节数据，同时记录压缩后的ziplist的数据大小</p><p>采用这种数据结构之后，连锁更新的问题被限制在quicklist的一个node上，而不影响整体的性能，所以兼顾了ziplist的节省内存的特性和规避了连锁更新的问题。那每个node下ziplist放多少数据呢？这个redis也把控制权下放给用户了，可以在<code>redis.conf</code>配置文件进行配置</p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">list-max-ziplist-size -2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>默认值是<code>-2</code></p><p>-1：4kb（good）好</p><p>-2：8kb（good）好</p><p>-3：16kb（probably not recomment）一般不建议</p><p>-4：32kb（not recommend）不建议</p><p>-5：64kb（not recommend for normal workloads）正常的工作负载下不建议</p></blockquote><h3 id="_2-4、set类型" tabindex="-1"><a class="header-anchor" href="#_2-4、set类型"><span>2.4、Set类型</span></a></h3><h4 id="_2-4-1、set类型相关指令" tabindex="-1"><a class="header-anchor" href="#_2-4-1、set类型相关指令"><span>2.4.1、Set类型相关指令</span></a></h4>`,20)),n("ul",null,[n("li",null,[n("a",b,[s[6]||(s[6]=a("Set commands",-1)),t(e)])])]),s[16]||(s[16]=p(`<p><img src="http://blog.shengxiao.tech/images/image-20260116113833185.png" alt="image-20260116113833185"></p><p>比如：</p><ul><li>往集合里边添加几个元素</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd hobby football</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd hobby tabletennis</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd hobby drawing</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd hobby singing</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers hobby</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;football&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;tabletennis&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;drawing&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;singing&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>再添加一个集合，计算两个集合的交集</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd experts singing</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd experts dancing</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd experts speeching</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers experts</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;singing&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;dancing&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;speeching&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sinter hobby experts</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;singing&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>计算两个集合的并集</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sunion experts hobby</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;football&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;singing&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;dancing&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;speeching&quot;</span></span>
<span class="line"><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;drawing&quot;</span></span>
<span class="line"><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;tabletennis&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>从<code>hobby</code>集合中随机取出一个元素</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop hobby <span class="token number">1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;tabletennis&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-2、使用场景" tabindex="-1"><a class="header-anchor" href="#_2-4-2、使用场景"><span>2.4.2、使用场景</span></a></h4><p>简单体验了一下set的使用，可以看到Set是一个无序的集合，可以添加元素、随机取元素、取集合的交集并集等。所以我们可以结合这些能力做一些事情，比如抽奖、找共同好友、找共同话题等等</p><h4 id="_2-4-3、底层的数据结构-intset-dictht" tabindex="-1"><a class="header-anchor" href="#_2-4-3、底层的数据结构-intset-dictht"><span>2.4.3、底层的数据结构-intset+dictht</span></a></h4><p>redis的set类型value采用了两种数据结构，一个是intset，另一个是dictht哈希表</p><h5 id="_2-4-3-1、intset" tabindex="-1"><a class="header-anchor" href="#_2-4-3-1、intset"><span>2.4.3.1、intset</span></a></h5><p>如果set里存放的都是整形数据，且集合里边的元素个数小于512（默认）则采用的是intset，而且它是有序的。intset的结构如下图所示：</p><p><img src="http://blog.shengxiao.tech/images/image-20260116143438404.png" alt="image-20260116143438404"></p><p>当元素个数越来越多的时候，要进行集合的一些操作就越来越困难，性能会越来越差，所以就引入了dictht哈希表，而这个阈值也是可以在<code>redis.conf</code>文件中进行配置的：</p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">set-max-intset-entries 512</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_2-4-3-2、dictht" tabindex="-1"><a class="header-anchor" href="#_2-4-3-2、dictht"><span>2.4.3.2、dictht</span></a></h5><p>如果集合里边存放的不都是整数，或者集合里边的元素个数超过512个，redis则采用哈希表来存储set类型的value。dictht哈希表的格式前面已经介绍过了，这里不再赘述。</p><p>但是我们知道哈希表是一个key-value的格式，它如何保存set的呢？其实在redis中存放set元素的时候，这个哈希表只用到了每个dictEntry的key，没有用到value，也就是说它是将这些元素保存在哈希表的key中的，所有dictEntry的value都是null。</p><h3 id="_2-5、sorted-set类型" tabindex="-1"><a class="header-anchor" href="#_2-5、sorted-set类型"><span>2.5、Sorted Set类型</span></a></h3><h4 id="_2-5-1、sorted-set类型相关的指令" tabindex="-1"><a class="header-anchor" href="#_2-5-1、sorted-set类型相关的指令"><span>2.5.1、Sorted Set类型相关的指令</span></a></h4>`,24)),n("ul",null,[n("li",null,[n("a",v,[s[7]||(s[7]=a("Sorted set commands",-1)),t(e)])])]),s[17]||(s[17]=p(`<p><img src="http://blog.shengxiao.tech/images/image-20260116144539968.png" alt="image-20260116144539968"></p><p>比如：</p><ul><li>往集合中添加几个元素，表示某个人的朋友圈，其中的数值代表亲密度</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd friends <span class="token number">19</span> polly</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd friends <span class="token number">11</span> lucy</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd friends <span class="token number">16</span> lily</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd friends <span class="token number">14</span> hanmeimei</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看朋友列表</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange friends <span class="token number">0</span> <span class="token parameter variable">-1</span> REV</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;polly&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;lily&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;hanmeimei&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;lucy&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到亲密度最高的polly，其次是lily。zrange默认是升序排列的，上面的命令加了一个<code>REV</code>参数，表示反转</p><ul><li>给lucy的亲密度增加10</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zincrby friends <span class="token number">10</span> lucy</span>
<span class="line"><span class="token string">&quot;21&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange friends <span class="token number">0</span> <span class="token parameter variable">-1</span> REV</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;lucy&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;polly&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;lily&quot;</span></span>
<span class="line"><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;hanmeimei&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到，lucy就跑最上边去了</p><ul><li>随机找两个好朋友</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrandmember friends <span class="token number">2</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;polly&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;lucy&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-5-2、使用场景" tabindex="-1"><a class="header-anchor" href="#_2-5-2、使用场景"><span>2.5.2、使用场景</span></a></h4><p>前面简单体验了一下sorted set的类型，主要比set多了一个score，redis会根据这个score值进行排序，默认升序，查询的时候可以指定升序还是降序。前面示例演示的是一个朋友圈的例子，其实只要是在一些有序集合的场景都可以尝试一下看能不能用sorted set来解决我们的业务问题。比如文章或视频的热度排序、公司内部排名等</p><h4 id="_2-5-3、底层数据结构-ziplist-skiplist-跳表" tabindex="-1"><a class="header-anchor" href="#_2-5-3、底层数据结构-ziplist-skiplist-跳表"><span>2.5.3、底层数据结构-ziplist+skiplist（跳表）</span></a></h4><h5 id="_2-5-3-1、ziplist" tabindex="-1"><a class="header-anchor" href="#_2-5-3-1、ziplist"><span>2.5.3.1、ziplist</span></a></h5><p>为了节约空间，redis的sorted set类型默认情况下也会考虑用ziplist。但由于它的硬伤是连锁更新问题，所以也只能在一定数据量的条件下使用，这个阈值同样可配：</p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">zset-max-ziplist-entries 128</span>
<span class="line">zset-max-ziplist-value 64</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>元素个数小于128个，value的长度小于64个字节</p><h5 id="_2-5-3-2、skiplist" tabindex="-1"><a class="header-anchor" href="#_2-5-3-2、skiplist"><span>2.5.3.2、skiplist</span></a></h5><p>跳表是二分法查找的实现，也是一种空间换时间的思想。它的代码定义如下所示：</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token comment">/* ZSETs use a specialized version of Skiplists */</span></span>
<span class="line"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token punctuation">{</span></span>
<span class="line">    sds ele<span class="token punctuation">;</span> <span class="token comment">//sds数据</span></span>
<span class="line">    <span class="token keyword">double</span> score<span class="token punctuation">;</span> <span class="token comment">//score</span></span>
<span class="line">    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>backward<span class="token punctuation">;</span> <span class="token comment">//后退指针</span></span>
<span class="line">    <span class="token comment">//层级数组</span></span>
<span class="line">    <span class="token keyword">struct</span> <span class="token class-name">zskiplistLevel</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>forward<span class="token punctuation">;</span> <span class="token comment">//前进指针</span></span>
<span class="line">        <span class="token keyword">unsigned</span> <span class="token keyword">long</span> span<span class="token punctuation">;</span> <span class="token comment">//跨度</span></span>
<span class="line">    <span class="token punctuation">}</span> level<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span> zskiplistNode<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//跳表列表</span></span>
<span class="line"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplist</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>header<span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">;</span> <span class="token comment">//头尾节点</span></span>
<span class="line">    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> length<span class="token punctuation">;</span> <span class="token comment">//节点数量</span></span>
<span class="line">    <span class="token keyword">int</span> level<span class="token punctuation">;</span> <span class="token comment">//最大的节点层级</span></span>
<span class="line"><span class="token punctuation">}</span> zskiplist<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>比如要在下面这个结构中找到27：</p><p><img src="http://blog.shengxiao.tech/images/image-20260116151147038.png" alt="image-20260116151147038"></p><p>首先遍历第一层，找到22、40，而27刚好处于这个区间</p><p>然后遍历第二层，从22开始，找到22、35，而27也刚好在这个区间</p><p>然后遍历第三层，从22开始，找到22、27，然后就找到了</p><p>跳表的层级设计在数据量比较大的时候性能优势会更加明显，在redis中最大支持32层，因为层级越高查询性能越慢。</p><h3 id="_2-6、bitmap类型" tabindex="-1"><a class="header-anchor" href="#_2-6、bitmap类型"><span>2.6、bitmap类型</span></a></h3><h4 id="_2-6-1、bitmap类型相关指令" tabindex="-1"><a class="header-anchor" href="#_2-6-1、bitmap类型相关指令"><span>2.6.1、bitmap类型相关指令</span></a></h4>`,30)),n("ul",null,[n("li",null,[n("a",h,[s[8]||(s[8]=a("Bitmap commands",-1)),t(e)])])]),s[18]||(s[18]=p(`<p><img src="http://blog.shengxiao.tech/images/image-20260116154242760.png" alt="image-20260116154242760"></p><p>比如：</p><ul><li>设置bitmap的第3位为1</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit bitmap <span class="token number">1</span> <span class="token number">1</span></span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit bitmap <span class="token number">1</span></span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit bitmap <span class="token number">1558456912</span> <span class="token number">1</span></span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看设置了多少位</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> bitcount bitmap</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>bitmap的操作比较简单，核心的指令就是设置某一个bit位的数值和获取某一个bit位的数值。由于是基于bit位的存储方式，所以占用的内存也比较小，假设一共有10亿位，则占用的空间：10 0000 0000 / 8 / 1024 / 1024 ≈ 119.2 mb</p><h4 id="_2-6-2、使用场景" tabindex="-1"><a class="header-anchor" href="#_2-6-2、使用场景"><span>2.6.2、使用场景</span></a></h4><p>前面的使用可以体验到用极致的空间来达到一个比较大的数据量的存储，而且是基于位的，使用起来也非常简单，还可以统计设置了多少个bit位，所以这让我们一下就想到了统计在线人数的场景。用用户id对应的比特位作为该用户的标识，如果用户在线，则将对应的位标记为1，否则就是0，要查看用户是否在线也非常简单，直接<code>getbit</code>就可以了。但是要注意用户id不连续导致的空间浪费问题</p><p>此外，类似的还可以来统计日活和次日留存，比如</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 记录2023-01-01的活跃用户</span></span>
<span class="line">SETBIT dau:20230101 <span class="token number">1001</span> <span class="token number">1</span></span>
<span class="line">SETBIT dau:20230101 <span class="token number">1002</span> <span class="token number">1</span></span>
<span class="line"><span class="token comment"># 计算两日重叠用户数（交集）</span></span>
<span class="line">BITOP AND dau:retention dau:20230101 dau:20230102</span>
<span class="line">BITCOUNT dau:retention</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>签到、连续打卡</p><h4 id="_2-6-3、底层数据结构-sds" tabindex="-1"><a class="header-anchor" href="#_2-6-3、底层数据结构-sds"><span>2.6.3、底层数据结构- SDS</span></a></h4><p>Redis的Bitmap底层是基于String类型实现的一个bit位数组，Bitmap操作直接在SDS的二进制数据上执行，避免额外的内存开销。</p><h3 id="_2-7、hyperloglog-类型-基于string类型" tabindex="-1"><a class="header-anchor" href="#_2-7、hyperloglog-类型-基于string类型"><span>2.7、HyperLogLog 类型（基于String类型）</span></a></h3><h4 id="_2-7-1、hyperloglog类型相关指令" tabindex="-1"><a class="header-anchor" href="#_2-7-1、hyperloglog类型相关指令"><span>2.7.1、HyperLogLog类型相关指令</span></a></h4>`,16)),n("ul",null,[n("li",null,[n("a",g,[s[9]||(s[9]=a("HyperLogLog commands",-1)),t(e)])])]),s[19]||(s[19]=p(`<p><img src="http://blog.shengxiao.tech/images/image-20260116154314353.png" alt="image-20260116154314353"></p><p>比如：</p><ul><li>添加几个元素（两个key分别表示学习Java、php以及python的学生）</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd stu:java lily david</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd stu:php lilei hanmeimei polly</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd stu:python polly lucy</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>统计学生总数</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfmerge stu stu:java stu:php stu:python</span>
<span class="line">OK</span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount stu</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>先将几个key合并，然后统计</p></blockquote><h4 id="_2-7-2、使用场景" tabindex="-1"><a class="header-anchor" href="#_2-7-2、使用场景"><span>2.7.2、使用场景</span></a></h4><p>从上面的演示案例以及redis提供的指令可以看到，HyperLogLog 擅长的是基数统计方面的功能，所以可以用来做网站或app的日活、pv、uv统计等</p><p>**注意：**HyperLogLog是基于伯努利过程的概率学基数统计，所以并不是完全精确的值</p><h4 id="_2-7-3、底层数据结构" tabindex="-1"><a class="header-anchor" href="#_2-7-3、底层数据结构"><span>2.7.3、底层数据结构</span></a></h4><p>HyperLogLog的定义如下：</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">hllhdr</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">char</span> magic<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">uint8_t</span> encoding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">uint8_t</span> notused<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">uint8_t</span> card<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">uint8_t</span> registers<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>1、magic[4]：这个字段是一个 4 字节的字符数组，用来表示数据结构的标识符。在 HyperLogLog 中，它的值始终为&quot;HYLL&quot;，用来标识这是一个 HyperLogLog 数据结构。</p><p>2、encoding：这是一个 1 字节的字段，用来表示 HyperLogLog 的编码方式。它可以取两个值之一：</p><ul><li><code>HLL_DENSE</code>：表示使用稠密表示方式。</li><li><code>HLL_SPARSE</code>：表示使用稀疏表示方式。</li></ul><p>3、notused[3]：这是一个 3 字节的字段，目前保留用于未来的扩展，要求这些字节的值必须为零。</p><p>4、card[8]：这是一个 8 字节的字段，用来存储缓存的基数（基数估计的值）。</p><p>5、egisters[]：这个字段是一个可变长度的字节数组，用来存储 HyperLogLog 的数据。</p></blockquote><p>结构如图所示：</p><p><img src="http://blog.shengxiao.tech/images/image-20260116174315420.png" alt="image-20260116174315420"></p><p>Redis 对 <code>HyperLogLog</code> 的存储进行了优化，在计数比较小的时候，存储空间采用系数矩阵，占用空间很小。只有在计数很大，稀疏矩阵占用的空间超过了阈值才会转变成稠密矩阵，占用 12KB 空间。</p><h3 id="_2-8、geospatial-类型" tabindex="-1"><a class="header-anchor" href="#_2-8、geospatial-类型"><span>2.8、Geospatial 类型</span></a></h3><h4 id="_2-8-1、geospatial类型相关指令" tabindex="-1"><a class="header-anchor" href="#_2-8-1、geospatial类型相关指令"><span>2.8.1、Geospatial类型相关指令</span></a></h4>`,19)),n("ul",null,[n("li",null,[n("a",y,[s[10]||(s[10]=a("Geospatial commands",-1)),t(e)])])]),s[20]||(s[20]=p(`<p><img src="http://blog.shengxiao.tech/images/image-20260116154349448.png" alt="image-20260116154349448"></p><p>比如：</p><ul><li>添加两个坐标，北京和武汉</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd China <span class="token number">116.7244748284355</span> <span class="token number">39.90504785214505</span> beijing</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd China <span class="token number">114.30524758454877</span> <span class="token number">30.592752001304746</span> wuhan</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd China <span class="token number">116.70892241361364</span> <span class="token number">39.50940532715634</span> langfang</span>
<span class="line"><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>计算北京到武汉的距离</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geodist China beijing wuhan</span>
<span class="line"><span class="token string">&quot;1058699.1391&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>用百度地图工具测量一下：https://map.baidu.com/</p><p><img src="http://blog.shengxiao.tech/images/image-20260116180420580.png" alt="image-20260116180420580"></p><p>可以看到还是毕竟精确的，结果大差不差</p><ul><li>查看北京的坐标</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geopos China beijing</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.7244765162468&quot;</span></span>
<span class="line">   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.90504672149917&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看附近的元素</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius China <span class="token number">117.00631090246314</span> <span class="token number">39.76171292883689</span> <span class="token number">100</span> km</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;langfang&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius China <span class="token number">117.00631090246314</span> <span class="token number">39.76171292883689</span> <span class="token number">30</span> km withcoord</span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span></span>
<span class="line">   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.7244765162468&quot;</span></span>
<span class="line">      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.90504672149917&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius China <span class="token number">117.00631090246314</span> <span class="token number">39.76171292883689</span> <span class="token number">130</span> km withcoord count <span class="token number">1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span></span>
<span class="line">   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.7244765162468&quot;</span></span>
<span class="line">      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.90504672149917&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius China <span class="token number">117.00631090246314</span> <span class="token number">39.76171292883689</span> <span class="token number">130</span> km withcoord count <span class="token number">2</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span></span>
<span class="line">   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.7244765162468&quot;</span></span>
<span class="line">      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.90504672149917&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;langfang&quot;</span></span>
<span class="line">   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.70892506837845&quot;</span></span>
<span class="line">      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.50940463045911&quot;</span></span>
<span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius China <span class="token number">117.00631090246314</span> <span class="token number">39.76171292883689</span> <span class="token number">130</span> km withcoord withdist count <span class="token number">1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span></span>
<span class="line">   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;28.8725&quot;</span></span>
<span class="line">   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.7244765162468&quot;</span></span>
<span class="line">      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.90504672149917&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>117.00631090246314 39.76171292883689是廊坊市香河县的坐标</p><p>count：查询几个结果</p><p>withcoord：把查询结果的经纬度也带出来</p><p>withdist：把结果的距离也带出来</p></blockquote><h4 id="_2-8-2、使用场景" tabindex="-1"><a class="header-anchor" href="#_2-8-2、使用场景"><span>2.8.2、使用场景</span></a></h4><p>使用场景就比较明显了，主要用在地图领域</p><h4 id="_2-8-3、底层数据结构" tabindex="-1"><a class="header-anchor" href="#_2-8-3、底层数据结构"><span>2.8.3、底层数据结构</span></a></h4><p>Geospatial 底层是基于zset进行封装的，比如我们可以用zset的指令操作集合里的元素</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange China <span class="token number">0</span> <span class="token parameter variable">-1</span></span>
<span class="line"><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span></span>
<span class="line"><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;langfang&quot;</span></span>
<span class="line"><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p><img src="http://blog.shengxiao.tech/images/subscribe1.png" alt="扫码关注"></p>`,21))])}const x=l(r,[["render",f]]),w=JSON.parse('{"path":"/series/distribution/Redis/02Redischangyongshujuleixingyijishiyongchangjing.html","title":"2、Redis的Value的常见数据类型以及使用场景","lang":"en-US","frontmatter":{"title":"2、Redis的Value的常见数据类型以及使用场景","date":"2026-01-16T00:00:00.000Z","categories":["分布式","Redis"],"tags":["分布式","Redis"]},"headers":[{"level":2,"title":"1、redis的数据结构","slug":"_1、redis的数据结构","link":"#_1、redis的数据结构","children":[{"level":3,"title":"1.1、redis的数据结构","slug":"_1-1、redis的数据结构","link":"#_1-1、redis的数据结构","children":[]},{"level":3,"title":"1.2、扩容","slug":"_1-2、扩容","link":"#_1-2、扩容","children":[]}]},{"level":2,"title":"2、redis的value常见数据类型","slug":"_2、redis的value常见数据类型","link":"#_2、redis的value常见数据类型","children":[{"level":3,"title":"2.1、String类型","slug":"_2-1、string类型","link":"#_2-1、string类型","children":[]},{"level":3,"title":"2.2、Hash类型","slug":"_2-2、hash类型","link":"#_2-2、hash类型","children":[]},{"level":3,"title":"2.3、List类型","slug":"_2-3、list类型","link":"#_2-3、list类型","children":[]},{"level":3,"title":"2.4、Set类型","slug":"_2-4、set类型","link":"#_2-4、set类型","children":[]},{"level":3,"title":"2.5、Sorted Set类型","slug":"_2-5、sorted-set类型","link":"#_2-5、sorted-set类型","children":[]},{"level":3,"title":"2.6、bitmap类型","slug":"_2-6、bitmap类型","link":"#_2-6、bitmap类型","children":[]},{"level":3,"title":"2.7、HyperLogLog 类型（基于String类型）","slug":"_2-7、hyperloglog-类型-基于string类型","link":"#_2-7、hyperloglog-类型-基于string类型","children":[]},{"level":3,"title":"2.8、Geospatial 类型","slug":"_2-8、geospatial-类型","link":"#_2-8、geospatial-类型","children":[]}]}],"git":{"createdTime":1766909059000,"updatedTime":1768626552000,"contributors":[{"name":"qknavy","email":"qknavy@aliyun.com","commits":3}]},"filePathRelative":"series/distribution/Redis/02Redis常用数据类型以及使用场景.md"}');export{x as comp,w as data};
