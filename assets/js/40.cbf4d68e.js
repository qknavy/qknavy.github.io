(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{552:function(s,a,t){"use strict";t.r(a);var e=t(4),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("es作为当前流行的搜索引擎、数据分析中间件以及监控管理工具，其数据安全性和数据库一样非常重要，但是默认安装的时候是没有设置任何保护措施的，需要手动设置")])]),s._v(" "),t("h2",{attrs:{id:"_1、记elasticsearch的一次网络攻击"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、记elasticsearch的一次网络攻击"}},[s._v("#")]),s._v(" 1、记ElasticSearch的一次网络攻击")]),s._v(" "),t("p",[s._v("在搭建的测试服务器上，刚开始es集群是“裸奔”状态，没有设置任何的密码，也没有配置证书，采用的安装方式也是解压即用的那种，仅仅是搭建了一个三个节点的小集群。")]),s._v(" "),t("p",[s._v("但是在运行的过程中发现原先创建的索引经常莫名其妙地不见了，往上问了一个大牛，给的回复是“ES作为一个成熟的产品，不可能主动去删你的索引数据，肯定是你用的不对，自己学的不到位不要甩锅ES”，说实话当时有点小小的郁闷，本来就是刚接触才拜的师嘛，不过最终还是接受对方的建议，重新搭建一次。")]),s._v(" "),t("p",[s._v("这一次倒是稳定运行了大约一个礼拜左右，但是后面还是出现了同样的问题，索引丢了，然后还莫名其妙多了几个以"),t("code",[s._v("Meow")]),s._v("结尾的索引，如图所示：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://qknavy.oss-cn-huhehaote.aliyuncs.com/%E5%9B%BE%E7%89%87/meow.png",alt:"meow攻击"}})]),s._v(" "),t("p",[s._v("后来在网上搜到一篇文章 [参考1]([https://blog.csdn.net/GJLNaughtyCat/article/details/107830083?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-1-107830083.nonecase&utm_term=es%20meow%20%E7%B4%A2%E5%BC%95%E5%90%8D%E5%AD%97%E9%83%BD%E5%8F%98%E4%BA%86&spm=1000.2123.3001.4430](https://blog.csdn.net/GJLNaughtyCat/article/details/107830083?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-1-107830083.nonecase&utm_term=es meow 索引名字都变了&spm=1000.2123.3001.4430)) ，也有人遇到过同样的问题，问题的根源在于不安全的ES，虽然没有去细看es日志，但是找到根源就对症下药。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.searchenginejournal.com/meow-attack/375764/#close",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考2"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2、设置密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、设置密码"}},[s._v("#")]),s._v(" 2、设置密码")]),s._v(" "),t("h3",{attrs:{id:"_2-1、开启xpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、开启xpack"}},[s._v("#")]),s._v(" 2.1、开启xpack")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("config/elasticsearch.yaml")]),s._v("文件中开启"),t("code",[s._v("xpack")])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("xpack.security.enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("其它配置不变，正常将es运行起来")]),s._v(" "),t("h3",{attrs:{id:"_2-2、设置密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、设置密码"}},[s._v("#")]),s._v(" 2.2、设置密码")]),s._v(" "),t("p",[s._v("执行命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("./bin/elasticsearch-setup-passwords interactive\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这时候需要用户输入密码（很多个，所有涉及到ES的密码，为了能记住，可以都设置成一样的密码）")]),s._v(" "),t("h3",{attrs:{id:"_2-3、修改密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、修改密码"}},[s._v("#")]),s._v(" 2.3、修改密码")]),s._v(" "),t("ul",[t("li",[s._v("在已知原来密码的情况下，如果想要修改密码，可以通过下面命令：")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -u elastic "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost:9200/_security/user/elastic/_password"')]),s._v(" -H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -d"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"password" : "abcd1234"}\'')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("如果忘记原来的密码，就需要删掉"),t("code",[s._v(".security-7")]),s._v("索引，重启es，再重新执行设置密码的指令")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/163337278",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考文档"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);